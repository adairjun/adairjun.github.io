title: 如何使用hexo和github搭建自己的博客
date: 2015-11-04 19:57:18
categories: hexo
tags: hexo
---
目前想要建造自己的博客网站有这样几种方法：
> * 使用[WordPress](https://cn.wordpress.org/)加上云服务器,这种方法比较老，因为github的pages有300M免费空间，资料自己管理，保存可靠，所以现在的博客一般都使用github的pages来搭建。
> * 使用[Hexo](http://hexo.io/)加上[github的pages](https://pages.github.com/)
> * 使用[jekyll](http://jekyllcn.com/)或者[Octopress](http://octopress.org/)加上[github的pages](https://pages.github.com/)

我个人使用的是hexo的方法。由于个人电脑是Ubuntu系统，所以以下是在Ubuntu下的教程。


## 创建github pages

### 首先需要在自己的github上创建一个名为username.github.io的仓库(这里假设已经申请了github账号).比如我的github的账号名为adairjun，那么我就需要创建adairjun.github.io这个名称的github仓库.

### 接下来要做的工作是在命令行当中把这个仓库clone下来.

在clone之前需要配置一下ssh的秘钥，避免每次都输入密码.

``` 
$ ssh-keygen

```
就在~/.ssh/目录下生成了公钥id_rsa.pub和私钥id_rsa

登陆github系统。点击右上角的 Account Settings—>SSH Public keys —> add another public keys
将id_rsa.pub的内容复制下来，粘贴到github当中去.
在命令行测试一下是否成功：
``` 
$ ssh -T git@github.com

```
将username.github.io这个仓库clone到本地:
``` 
$ git clone git@github.com:username/username.github.io

```

### Hello World
进入到项目目录，并且增加index.html
``` 
$ cd username.github.io
$ echo "Hello World" > index.html
$ git add --all
$ git commit -m "Initial commit"
$ git push -u origin master

```
然后在浏览器当中访问username.github.io就能出现Hello World啦！我这里是adairjun.github.io,以后username.github.io就是你的博客域名。
但是难道每次写博客还需要手工编写index.html文件然后push到github上？当然不是，使用Hexo这个Node.js工具就能轻松写博客了。

## 安装Node.js



### 选择版本

在[Hexo的官网](https://hexo.io/docs/)上给出了教程:

``` 
$ nvm install 0.12

```
表明需要安装0.12版本的Node.js，接下来就到[Node.js的github](https://github.com/nodejs/node/releases?after=v2.4.0)上去下载release版本,我下载的版本是0.12.7

### 安装Node.js


``` 
$ tar -zxvf node-0.12.7.tar.gz
$ cd node-0.12.7
$ ./configure
$ make && sudo make install

```


那么node和npm就安装到了/usr/local/bin目录当中了.

### 使用npm的国内镜像来解决npm install的问题
编辑`~/.npmrc`加入以下内容:
```
registry = https://registry.npm.taobao.org
```
这样就加入了淘宝的镜像

## 安装Hexo

### home目录下,使用npm这个安装工具可以非常简单地安装
``` 
$ npm install hexo-cli -g
$ npm install hexo -g
$ npm install hexo-server -g
$ npm install hexo-deployer-git -g

```

### 在一个目录当中初始化Hexo
``` 
$ mkdir blog
$ cd blog
$ hexo init
```
或者在home目录下
``` 
$ hexo init blog
```
这样就创建了一个专门写博客的目录blog
### 配置blog目录,在blog目录下面执行
``` 
$ npm install
$ npm install hexo-deployer-git --save
```
### 复制wuchong的修改的主题
``` 
git clone https://github.com/wuchong/jacman.git themes/jacman
```
### 或者复制yangjian的主题
``` 
git clone https://github.com/A-limon/pacman.git themes/pacman
```
### 启用主题
修改Hexo目录下的_config.yml配置文件中的theme属性，将其设置为jacman或者pacman
``` 
theme: jacman
```
### 启动Hexo查看效果
``` 
$ hexo server
```
提示信息出现：
``` 
INFO Hexo is running at http://0.0.0.0:4000/. Press Ctrl+C to stop.
```
在浏览器当中访问http://0.0.0.0:4000/,可以看见Hexo的效果。
现在的问题是，blog目录是作为博客的服务器地址，而我们想把github配置成我们的服务器地址，所以下一步就是部署到github上

注意:
> 如果这里使用`hexo server`报错的话,请删除blog目录,再重新执行hexo init blog的操作.因为是初始化的问题,需要重头再来

### 部署到github上
### 部署到Github前需要配置_config.yml文件。
``` 
deploy:
  type: github
  repository: git@github.com:username/username.github.io.git
  branch: master
```
reponsitory配置成你的仓库地址，在这里我的是git@github.com:adairjun/adairjun.github.io.git

注意:
> type,responsitory,branch前面的两个空格不能去掉。否则使用hexo server启动时会报错。

### 执行下列指令即可完成部署，注意部署会覆盖掉你之前在username.github.io中存放的文件,在这里也就是index.html
``` 
$ hexo clean
$ hexo generate
$ hexo deploy
```
可以在hexo deploy之前，先运行hexo server查看一下启动有无问题。
hexo deploy之后，就可以通过http://username.github.io来访问hexo生成的页面

## 写博客
### hexo new
``` 
$ hexo new "这是一个新的开始"
```
执行命令后，会在项目/source/_posts中生成 这是一个新的开始.md文件，用编辑器打开编写即可。我一般使用sublime text 3
由于hexo使用的是Markdown语法，这里推荐[Cmd Markdown](https://www.zybuluo.com/mdeditor),可以在这个页面编辑好之后然后再复制到 这是一个新的开始.md文件当中

## 有关想使用github来备份自己的blog目录的做法
### 超简单方法
就是在自己的github上新建一个blog仓库,然后在本地的blog目录当中添加关联
### 不想使用多个仓库,只想用一个仓库既保存username.github.io,又保存blog
这就要使用到git的分支功能
可以看到在blog的_config.yml当中,使用的branch是master,那么我们只需要新建一个分支blog就行了
在本地的blog目录下添加远程github的关联
```
$ git init
$ git add -all
$ git commit -m"First Commit"
$ git remote add git@github.com:username/username.github.io.git
```
然后执行
```
$ git push origin master:blog
```
就是把本地master分支放到github的blog分支上.
下次想要从github里面clone出来blog分支只需要执行
```
$ git clone -b blog git@github.com:username/username.github.io.git blog
```
## 有关hexo3的代码块是白色的问题
hexo3写的代码并不是黑色的背景,看的很不舒服,解决方案是到`themes/pacman/source/css/_base`目录当中,注释掉`variable.styl`以下代码:
```
highlight = hexo-config("highlight.enable")
```
如果你使用的是jacman的主题的话,到`themes/jacman/_config.yml`当中
```
# 代码高亮主题
# available: default | night
highlight_theme: default 
```
把`default`改成`night`就可以了

## 有关jacman的首页默认是展开式的情况
```
index:
  expand: true           ## default is unexpanding,so you can only see the short description of each post.
  excerpt_link: Read More  
```
把expand由true改为false就可以了

## 关于自己的域名绑定到github.io上的方法

### 购买域名

推荐上[godaddy](https://sg.godaddy.com/)购买,因为听说国内的万网或者新网一点都不自由,说封就封.

### 域名绑定
使用[DNSpod](https://www.dnspod.cn/),以及[官方的帮助文件](https://support.dnspod.cn/Kb/showarticle/tsid/42/)可以简答地把godaddy和DNSpod绑定到一起。
在[DNSpod](https://www.dnspod.cn/)当中加上两条:
| 主机记录 | 记录类型 | 线路类型 | 记录值 | 权重 | MX优先级 | TTL | 操作 |
| @ | CNAME | 默认 | username.github.io | - | - | 600 |  |
| www | CNAME | 默认 | username.github.io | - | - | 600 |  |
这个的意思是当查找你的域名的时候,自动跳转到`username.github.io`上
设置完这个之后需要在`blog`目录下面的`source`目录当中创建一个文件`CNAME`
并在文件当中写上你的域名,比如我的就是`xiongjun.info`
